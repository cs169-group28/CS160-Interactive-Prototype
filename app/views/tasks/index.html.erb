<script>
  //forces the modal to reload on every click,
  //otherwise it is lazy and only loads content the first time
  //you use it
  $(document).ready(function(){
    $('#showTaskModal').on('hidden', function() {
        $(this).data('modal').$element.removeData();
    })
  });
</script>

<div class="container">
  <div class="row" style="margin-left:0px">

        <h1>Tasks for <%= @event.name %> </h1>

        <table class="table table-striped table-hover">
          <tr>
            <th>id</th>
            <th>Name</th>
            <th></th>
            <th></th>
            <th></th>
          </tr>

        <% @tasks.each do |task| %>
          <tr>
            <td><%= task.id %></td>
            <td style="margin:10px">
              <a style="cursor:pointer;font-size:1.5em" data-toggle="collapse" data-target="#<%= task.id %>"><%= task.name %></a>
              <div id="<%= task.id %>" class="collapse">
                <div class="well"><%= task.description%></div>
              </div>
            </td>
            <td><%= link_to 'Show', event_task_path(task.event_id, task), "data-toggle" => "modal", "data-target" => "#showTaskModal", :class => "btn btn-success", :style => "float:right" %></td>

            <!-- Edit has been removed b/c of user feedback
              <td style="width:10px"><%= link_to 'Edit', edit_event_task_path(task.event_id, task), :class => "btn btn-info", :style => "float:right" %></td> 
            -->
            
            <td style="width:10px"><%= link_to 'Delete', event_task_path(task.event_id, task), method: :delete, data: { confirm: 'Are you sure?' }, :class => "btn btn-danger", :style => "float:right" %></td>
          </tr>
        <% end %>
        </table>

        <br />

        <%= link_to 'New Task', new_event_task_path, :id => 'btn', :class => "btn btn-large btn-primary", "data-toggle" => "modal", "data-target" => "#newTaskModal"%>
        
  </div>
</div>

<div id="showTaskModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-body" style="max-height:80%; max-width:80%">
  </div>
</div>

<div id="newTaskModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-body" style="max-height:80%; max-width:80%">
  </div>
</div>

</div>